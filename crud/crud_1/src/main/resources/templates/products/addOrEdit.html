<!DOCTYPE html>
<!-- <html lang="en" xmlns:th="http://www.springframework.org/schema/data/jaxb"> -->
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>Add Product</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="/css/bootstrap.min.css"/>

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</head>

<body>
  <div class="col-3"></div>
  <div class="container col-6">
    <form th:action="@{/products/save}" method="post" enctype="multipart/form-data" th:object="${product}">
    <h1 th:text="${product.isEdit?'Edit Product':'Add New Product'}">New Product</h1>
    <div class="col-md-auto">
      <input type="hidden" th:field="*{isEdit}">
        <div>
          <label>Product-Id</label>
          <input id="productId" aria-describedby="productIdHid" type="text" class="form-control" placeholder="Id"
            th:field="*{productId}" readonly />
          <small id="productIdHid" th:if="${#fields.hasErrors('productId')}" class="form-text text-mutted">Product id
            is required</small>
        </div>
        <div style="clear: both; display: block; height: 10px"></div>
        <div>
          <label>Name</label>
          <input aria-describedby="nameHid" type="text" class="form-control" placeholder="Name" th:field="*{name}" />
          <small id="categoryIdHid" th:if="${#fields.hasErrors('name')}" class="form-text text-mutted">Name is required
            or invalid</small>
        </div>
        <div style="clear: both; display: block; height: 10px"></div>
        <div>
          <label>Quantity</label>
          <input aria-describedby="quantityHid" type="text" class="form-control" placeholder="Quantity"
            th:field="*{quantity}" />
          <small id="quantityHid" th:if="${#fields.hasErrors('name')}" class="form-text text-mutted">Quantity is
            required</small>
        </div>
        <div style="clear: both; display: block; height: 10px"></div>
        <label>Unit Price</label>
        <div class="input-group form-group">
          <input aria-describedby="quantityHid" type="number" class="form-control" placeholder="Unit Price"
            th:field="*{unitPrice}" />
          <span class="input-group-text">$</span>
        </div>
        <div style="clear: both; display: block; height: 10px"></div>
        <label>Category</label>
        <div class="form-group">
          <select class="form-control" name="categoryId" id="categoryId" th:field="*{categoryId}">
            <option th:each=" item: ${categories}" th:value="${item.categoryId}" th:text="${item.name}" 
            th:selected="item.categoryId == product.categoryId">
              Category Name</option>
           
          </select>
        </div>
        <div style="clear: both; display: block; height: 10px"></div>

        <script>
          function chooseFile(fileInput) {
            if(fileInput.files && fileInput.files[0]){
              var reader = new FileReader();

              reader.onload = function (e){
                $('#image').attr('src',e.target.result);
              }
               reader.readAsDataURL(fileInput.files[0]);
            }
          }
        </script>
        <img id="image"  th:src="${product.image!=null?'/products/images/' + product.image : '/images/noimage.jpg'}" src="/images/noimage.jpg" width="40%">
        <label>Image File</label>
        <div class="form-group">
          <input type="file" class="form-control-file" placeholder="productImage"
           aria-describedby="productImage" name="imageFile" onchange="chooseFile(this)">
          <small id="productImage" class="form-text text-muted">Produt image is required</small>
        </div>
        <div style="clear: both; display: block; height: 10px"></div>
        <label>Discount</label>
        <div class="input-group form-group">
          <input aria-describedby="quantityHid" type="number" class="form-control" placeholder="Discount"
            th:field="*{discount}" />
          <span class="input-group-text">%</span>
        </div>
        <div style="clear: both; display: block; height: 10px"></div>
        <label>Status</label>
        <div class="form-group">
          <select class="form-control" name="status" id="status" th:field="*{status}">
            <option value="0">Out of Stock</option>
            <option value="1">On Sale</option>
            <option value="2">Featured</option>
            <option value="3">Bestseller</option>
            <option value="4">Out of order</option>
          </select>
        </div>

        <div style="clear: both; display: block; height: 10px"></div>
        <div>
          <label>Description</label>
          <textarea aria-describedby="nameHid" type="text" class="form-control" placeholder="Description"
          th:field="*{description}"
          ></textarea>
         
        </div>
        <div style="clear: both; display: block; height: 10px"></div>
        <button class="btn btn-primary" th:text="${product.isEdit?'Update':'Save'}">Save</button>
        <a th:href="@{/products}" class="btn btn-success">List Product</a>
        <a th:if="${product.isEdit}" th:href="@{'/products/delete/' + ${product.productId}}" class="btn btn-danger">Delete</a>
        <div style="clear: both; display: block; height: 10px"></div>
        <div style="clear: both; display: block; height: 10px"></div>
      </form>

    </div>
  </div>
</body>

</html>

<!-- <div class="col-md-auto">
  <form th:object="${user}" th:action="@{save}" action="#" method="post">
    <div>
      <label th:text="Name" th:for="name"></label>
      <input type="text" th:field="*{name}" class="form-control" placeholder="Name"/>
    </div>
    <div style="clear: both; display: block; height: 10px"></div>
    <div>
      <label th:text="Email" th:for="email"></label>
      <input type="text" th:field="*{email}" class="form-control" placeholder="Email"/>
    </div>
    <div style="clear: both; display: block; height: 10px"></div>
    <div>
      <label th:text="Phone" th:for="phone"></label>
      <input type="text" th:field="*{phone}" class="form-control" placeholder="Phone"/>
    </div>
    <div style="clear: both; display: block; height: 10px"></div>
    <input type="submit" class="btn btn-success" value="Save"/>
  </form>
</div> -->